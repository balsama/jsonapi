services:
  serializer.normalizer.entity_reference_item.jsonapi:
    class: Drupal\jsonapi\Normalizer\EntityReferenceItemNormalizer
    arguments: ['@jsonapi.resource.manager']
    calls:
      - [setContainer, ['@service_container']]
    tags:
      - { name: normalizer, priority: 21 }
  serializer.normalizer.field_item.jsonapi:
    class: Drupal\jsonapi\Normalizer\FieldItemNormalizer
    tags:
      - { name: normalizer, priority: 21 }
  serializer.normalizer.field.jsonapi:
    class: Drupal\jsonapi\Normalizer\FieldNormalizer
    tags:
      - { name: normalizer, priority: 21 }
  serializer.normalizer.entity_reference_field.jsonapi:
    class: Drupal\jsonapi\Normalizer\EntityReferenceFieldNormalizer
    tags:
      - { name: normalizer, priority: 31 }
  serializer.normalizer.file_entity.jsonapi:
    class: Drupal\jsonapi\Normalizer\FileEntityNormalizer
    tags:
      - { name: normalizer, priority: 31 }
    arguments: ['@entity.manager', '@http_client', '@rest.link_manager', '@module_handler']
  serializer.normalizer.entity.jsonapi:
    class: Drupal\jsonapi\Normalizer\ContentEntityNormalizer
    arguments: ['@rest.link_manager', '@entity_type.manager', '@jsonapi.resource.manager']
    tags:
      - { name: normalizer, priority: 21 }
  serializer.normalizer.document_root.jsonapi:
    class: Drupal\jsonapi\Normalizer\DocumentRootNormalizer
    arguments: ['@rest.link_manager', '@entity_type.manager', '@jsonapi.resource.manager']
    tags:
      - { name: normalizer, priority: 22 }
  serializer.encoder.jsonapi:
    class: Drupal\jsonapi\Encoder\JsonEncoder
    tags:
      - { name: encoder, priority: 21, format: 'api_json' }
  jsonapi.resource.manager:
    class: Drupal\jsonapi\Configuration\ResourceManager
    arguments: ['@entity_type.manager', '@entity_type.bundle.info', '@config.factory']
  jsonapi.route_enhancer:
    class: Drupal\jsonapi\Routing\RouteEnhancer
    tags:
      - { name: route_enhancer }
  jsonapi.params.enhancer:
    class: Drupal\jsonapi\Routing\JsonApiParamEnhancer
    arguments: ['@entity_field.manager']
    tags:
      - { name: route_enhancer }
  jsonapi.query_builder:
    class: Drupal\jsonapi\Query\QueryBuilder
    arguments: [ '@entity_type.manager' ]
